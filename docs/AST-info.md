# AST解析节点信息

### **1. 实体（Entities）**

| **类别**           | **实体类型**        | **描述**                                                  | **属性**                                                                                                                                                                                                                                                                                                                                 |
| ------------------ | ------------------- | --------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **变量与常量**     | `Variable`          | 变量                                                      | `type` (enum `LocalVariable`, `GlobalVariable`, `MemberVariable`, `ConstVariable`, `BitfieldVariable`), `value` (int 存对应`Type`变量外键)                                                                                                                                                                                               |
|                    | `LocalVariable`     | 局部变量                                                  | `name`, `type` (int 存外键type_id), `isConst`, `isVolatile`, `isPointer`, `isReference`, `isArray`, `arraySize` (int 数组大小), `scopeId` (int 存外键scope_id, **TBC**), `isStatic`                                                                                                                                                      |
|                    | `GlobalVariable`    | 全局变量                                                  | `name`, `type`, `isConst`, `isVolatile`, `isPointer`, `isReference`, `isArray`, `arraySize` (int 数组大小), `fileId` (int 存外键file_id), `isExtern`                                                                                                                                                                                     |
|                    | `MemberVariable`    | 成员变量                                                  | `name`, `type`, `isConst`, `isVolatile`, `isPointer`, `isReference`, `isArray`, `arraySize` (int 数组大小), `classId` (int 存外键class_id), `access` (enum `public`, `protected`, `private`), `isStatic`, `isMutable`                                                                                                                    |
|                    | `ConstVaribale`     | 常量                                                      | `name`, `type`, `value` (string 常量值统一存为字符串，可根据`type`判断类型 or 删除此属性并结合关联外表记录), `isConstexpr`                                                                                                                                                                                                               |
|                    | `BitfieldVariable`  | 位域成员变量                                              | `name`, `type`, `bitSize` (bit), `bitOffset` (int)                                                                                                                                                                                                                                                                                       |
| **函数与方法**     | `Function`          | 函数                                                      | `name`, `returnType`, `parameters` (list), `isStatic`, `isInline`, `isNoexcept`, `isVariadic`, `isDeleted`, `isDefaulted`, `functionType` (enum `constructor`, `destructor`, `operator`),  `hasSideEffect`                                                                                                                               |
|                    | `Method`            | 成员方法                                                  | `name`, `returnType`, `parameters` (list), `classID` (int 存外键class_id), `isStatic`, `isVirtual`, `isPureVirtual`, `isConst`, `isInline`, `isNoexcept`, `isVariadic`, `isDeleted`, `isDefaulted`, `access` (enum `public`, `protected`, `private`), `functionType` (enum `constructor`, `destructor`, `operator`),  `hasSideEffect`    |
| **类型与模板**     | `Class`             | 类                                                        | `name`, `baseClasses` (list<string> 父类列表), `access` (enum `public`, `protected`, `private`), `isFinal`, `isAbstract`, `hasDestructor`, `hasCopyConstructor`, `isPOD`                                                                                                                                                                 |
|                    | `Struct`            | 结构体                                                    | `name`, `baseStructs` (list<string> 父结构体列表), `access` (enum `public`, `protected`, `private`), `isFinal`, `isAbstract`, `isPOD`                                                                                                                                                                                                    |
|                    | `Union`             | 联合体                                                    | `name`, `access` (enum `public`, `protected`, `private`), `isAnonymous`, `isPOD`                                                                                                                                                                                                                                                         |
|                    | `Enum`              | 枚举类型                                                  | `name`, `isScoped`, `underlyingType` (string 底层类型), `constants` (list<string> 枚举常量列表)                                                                                                                                                                                                                                          |
|                    | `Typedef`           | 类型别名                                                  | `name`, `aliases` (string 指向原始类型名称), `isFunctionPointer`                                                                                                                                                                                                                                                                         |
|                    | `Template`          | 模板（类模板/函数模板）                                   | `name`, `templateParameters` (list<int> 模板参数列表 存模板参数外键template_parameter_id), `isSpecialization`, `templateParameterKind` (enum `type`, `non-type`, `template`), `hasDefaultArgument`                                                                                                                                       |
|                    | `AnonymousStruct`   | 匿名结构体/联合体                                         | `contains` (list<string> 包含的成员列表 存成员变量名称), `isUnion`                                                                                                                                                                                                                                                                       |
| **控制流与数据流** | `Statement`         | 语句                                                      | `stmtType` (enum `IfStmt`, `ForStmt`, `WhileStmt`, `ReturnStmt`, `GotoStmt`, `SwitchStmt`), `location`, `condition` (int 存外键expression_id 仅用于`IfStmt`), `targetLabel` (int 存外键跳转目标标签label_id 仅用于`GotoStmt`)                                                                                                            |
|                    | `Label`             | 标签语句                                                  | `name`, `location`, `associatedStmt` (int 存外键关联的语句statement_id)                                                                                                                                                                                                                                                                  |
|                    | `Operand`           | 操作数                                                    | `type` (enum `Variable`, `Expression`), `value` (int 存对应`Type`操作数外键)                                                                                                                                                                                                                                                             |
|                    | `Expression`        | 表达式                                                    | `exprType` (enum `BinaryExpr`, `UnaryExpr`, `CallExpr`, `AssignmentExpr`, `SizeOfExpr`), `operands` (list<int> 存外键operand_id 引入外表operand 区分变量与表达式作操作数), `resultType` (int 存外键关联结果变量variable_id 仅用于`AssignmentExpr`)                                                                                       |
|                    | `Def`               | 变量定义位置                                              | `variable` (int 存外键variable_id), `location`                                                                                                                                                                                                                                                                                           |
|                    | `Use`               | 变量使用位置                                              | `variable` (int 存关联变量外键variable_id), `location`, `context` (int 存关联变量使用所在上下文的语句外键expression_id)                                                                                                                                                                                                                  |
| **预处理与内存**   | `Macro`             | 预处理宏                                                  | `name` (string 宏定义的name), `definition` (string 宏定义的文本内容), `isFunctionLike`, `parameters` (list<string> 函数宏参数列表 仅用于`FunctionMacro`), `expandedLocation` (list<string> 宏展开位置, 可视为`location`的列表), `macroType` (enum `ObjectMacro`, `FunctionMacro`, `ConditionalMacro`), `isDefinedInHeader`, `isIncluded` |
|                    | `MemoryOperation`   | 内存操作                                                  | `operationType` (enum `NewSingle`, `NewArray`, `Delete`, `Malloc`, `Free`), `allocatedType` (string 内存操作分配的类型), `sizeExpr` (int 存分配大小的表达式外键expression_id), `isArray`, `alignment` (int 分配时的对齐要求), `isDeleted`, `isFreed`, `isPlacementNew`                                                                   |
| **其他**           | `File`              | 文件                                                      | `path` (string), `name`, `isHeader`, `isSource`, `includes` (list<int> 包含其他文件的file_id), `defines` (list<int> 文件中定义的宏的外键macro_id)                                                                                                                                                                                        |
|                    | `Attribute`         | 编译器属性（如 `[[nodiscard]]`, `__declspec(dllexport)`） | `name`, `arguments` (list<string>), `target` (修饰的目标实体外键entity_id), `location`                                                                                                                                                                                                                                                   |
|                    | `Friend`            | 友元声明                                                  | `friendEntity` (关联被声明为友元的实体外键entity_id), , `declaringEntity`, `location`                                                                                                                                                                                                                                                    |
|                    | `Namespace`         | 命名空间                                                  | `name`, `scope` (int 存父级命名空间scope_id), `entities` (list<int> 命名空间内定义的实体外键entity_id), `location`                                                                                                                                                                                                                       |
|                    | `Value`             | 值(常量值, 参数默认值)                                    | `type`, **TBC**                                                                                                                                                                                                                                                                                                                          |
|                    | `Type`              | 类型                                                      | `name`, `isPrimitive`, `isPointer`, `isReference`, `isArray`, `arraySize`, `baseType` (int 存关联基础类型type_id int * int & int[] -> int)                                                                                                                                                                                               |
|                    | `Parameter`         | 参数                                                      | `name`, `type`, `defaultValue` (int 存默认值外键value_id), `isVarArgs`, `isConst`, `isPointer`, `isReference`, `location`                                                                                                                                                                                                                |
|                    | `TemplateParameter` | 模板参数                                                  | `name`, `kind` (string 模板参数的类型), `defaultValue` (string), `isVariadic`                                                                                                                                                                                                                                                            |
|                    | `Exception`         | 异常                                                      | `name`, `location`                                                                                                                                                                                                                                                                                                                       |
|                    | `Mutex`             | 线程锁                                                    | `name`, `lockStatements` (list<int> 存加锁的语句外键statement_id), `unlockStatements` (list<int> 存解锁的语句外键statement_id)                                                                                                                                                                                                           |